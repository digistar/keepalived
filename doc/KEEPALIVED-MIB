-- ----------------------------------------------------------------------
-- MIB file for keepalived (http://www.keepalived.org)
-- ----------------------------------------------------------------------
--
-- There are two sections in this MIB: vrrp and check.

KEEPALIVED-MIB DEFINITIONS ::= BEGIN

IMPORTS
    OBJECT-TYPE, MODULE-IDENTITY,
    Integer32, enterprises
        FROM SNMPv2-SMI
    OBJECT-GROUP, MODULE-COMPLIANCE
    	FROM SNMPv2-CONF
    InetAddressType, InetAddress,
    InetAddressPrefixLength, InetScopeType
    	FROM INET-ADDRESS-MIB
    InterfaceIndex
    	FROM IF-MIB
    DisplayString, TruthValue
        FROM SNMPv2-TC;

keepalived MODULE-IDENTITY
     LAST-UPDATED "200904080000Z"
     ORGANIZATION "Keepalived"
     CONTACT-INFO "http://www.keepalived.org"
     DESCRIPTION
        "This MIB describes objects used by keepalived, both
         for VRRP and health checker."

     REVISION "200904080000Z"
     DESCRIPTION "Initial revision"

     ::= { enterprises 60000 }

vrrp                    OBJECT IDENTIFIER ::= { keepalived 1 }
check                   OBJECT IDENTIFIER ::= { keepalived 2 }
conformance		OBJECT IDENTIFIER ::= { keepalived 3 }

-- ----------------------------------------------------------------------
-- VRRP part
-- ----------------------------------------------------------------------

vrrpKeepalivedVersion OBJECT-TYPE
    SYNTAX DisplayString
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Version of keepalived"
    ::= { vrrp 1 }

-- VRRP scripts
-- see vrrp_track.h

vrrpScriptTable OBJECT-TYPE
    SYNTAX SEQUENCE OF VrrpScriptEntry
    MAX-ACCESS not-accessible
    STATUS current
    DESCRIPTION
        "Table of VRRP scripts"
    ::= { vrrp 2 }

vrrpScriptEntry OBJECT-TYPE
    SYNTAX VrrpScriptEntry
    MAX-ACCESS not-accessible
    STATUS current
    DESCRIPTION
        "Information describing a VRRP script"
    INDEX { vrrpScriptIndex }
    ::= { vrrpScriptTable 1 }

VrrpScriptEntry ::= SEQUENCE {
	vrrpScriptIndex Integer32,
        vrrpScriptName DisplayString,
        vrrpScriptCommand DisplayString,
        vrrpScriptInterval Integer32,
        vrrpScriptWeight Integer32,
        vrrpScriptResult INTEGER
}

vrrpScriptIndex OBJECT-TYPE
    SYNTAX Integer32 (1..2147483647)
    MAX-ACCESS not-accessible
    STATUS current
    DESCRIPTION
	"Script index."
    ::= { vrrpScriptEntry 1 }

vrrpScriptName OBJECT-TYPE
    SYNTAX DisplayString
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
        "Symbolic name of the script."
    ::= { vrrpScriptEntry 2 }

vrrpScriptCommand OBJECT-TYPE
    SYNTAX DisplayString
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
        "Command executed when running the script."
    ::= { vrrpScriptEntry 3 }

vrrpScriptInterval OBJECT-TYPE
    SYNTAX Integer32
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
        "Interval in seconds between two runs of the script."
    ::= { vrrpScriptEntry 4 }

vrrpScriptWeight OBJECT-TYPE
    SYNTAX Integer32
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
        "Weight of the script if successful."
    ::= { vrrpScriptEntry 5 }

vrrpScriptResult OBJECT-TYPE
    SYNTAX INTEGER {
        disabled(0),
        init(1),
        none(2),
        good(3),
        initgood(4)
           }
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
        "Current status of the script."
    ::= { vrrpScriptEntry 6 }

-- Static ip addresses
-- see vrrp_address.h

vrrpStaticAddressTable OBJECT-TYPE
    SYNTAX SEQUENCE OF VrrpStaticAddressEntry
    MAX-ACCESS not-accessible
    STATUS current
    DESCRIPTION
        "Table of static addresses"
    ::= { vrrp 3 }

vrrpStaticAddressEntry OBJECT-TYPE
    SYNTAX VrrpStaticAddressEntry
    MAX-ACCESS not-accessible
    STATUS current
    DESCRIPTION
        "Information describing a static address"
    INDEX { vrrpStaticAddressIndex }
    ::= { vrrpStaticAddressTable 1 }

VrrpStaticAddressEntry ::= SEQUENCE {
	vrrpStaticAddressIndex Integer32,
        vrrpStaticAddressType InetAddressType,
	vrrpStaticAddressValue InetAddress,
	vrrpStaticAddressBroadcast InetAddress,
	vrrpStaticAddressMask InetAddressPrefixLength,
	vrrpStaticAddressScope InetScopeType,
	vrrpStaticAddressIfIndex InterfaceIndex,
	vrrpStaticAddressIfName DisplayString,
	vrrpStaticAddressIfAlias DisplayString,
	vrrpStaticAddressIsSet TruthValue
}

vrrpStaticAddressIndex OBJECT-TYPE
    SYNTAX Integer32 (1..2147483647)
    MAX-ACCESS not-accessible
    STATUS current
    DESCRIPTION
	"Static address index."
    ::= { vrrpStaticAddressEntry 1 }

vrrpStaticAddressType OBJECT-TYPE
    SYNTAX InetAddressType
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"A value that represents a type of Internet address."
    ::= { vrrpStaticAddressEntry 2 }

vrrpStaticAddressValue OBJECT-TYPE
    SYNTAX InetAddress
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Actual static ip address."
    ::= { vrrpStaticAddressEntry 3 }

vrrpStaticAddressBroadcast OBJECT-TYPE
    SYNTAX InetAddress
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Broadcast address associated with the static address."
    ::= { vrrpStaticAddressEntry 4 }

vrrpStaticAddressMask OBJECT-TYPE
    SYNTAX InetAddressPrefixLength
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Static address mask."
    ::= { vrrpStaticAddressEntry 5 }

vrrpStaticAddressScope OBJECT-TYPE
    SYNTAX InetScopeType
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Static address scope."
    ::= { vrrpStaticAddressEntry 6 }

vrrpStaticAddressIfIndex OBJECT-TYPE
    SYNTAX InterfaceIndex
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Index of the interface to which the static address is linked to."
    ::= { vrrpStaticAddressEntry 7 }

vrrpStaticAddressIfName OBJECT-TYPE
    SYNTAX DisplayString
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Name of the interface to which the static address is linked to."
    ::= { vrrpStaticAddressEntry 8 }

vrrpStaticAddressIfAlias OBJECT-TYPE
    SYNTAX DisplayString
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"Alias name of the interface."
    ::= { vrrpStaticAddressEntry 9 }

vrrpStaticAddressIsSet OBJECT-TYPE
    SYNTAX TruthValue
    MAX-ACCESS read-only
    STATUS current
    DESCRIPTION
	"true(1) if the address is set, false(0) otherwise."
    ::= { vrrpStaticAddressEntry 10 }

-- ----------------------------------------------------------------------
-- Conformance
-- ----------------------------------------------------------------------

compliances  OBJECT IDENTIFIER ::= { conformance 1 }
groups	     OBJECT IDENTIFIER ::= { conformance 2 }

vrrpCompliances MODULE-COMPLIANCE
    STATUS current
    DESCRIPTION
	"The core compliance statement"
    MODULE -- this module
    MANDATORY-GROUPS {
    	vrrpGroup,
	vrrpScriptGroup,
	vrrpStaticAddressGroup
    }
    ::= { compliances 1 }

vrrpGroup OBJECT-GROUP
    OBJECTS {
    	vrrpKeepalivedVersion
	}
    STATUS current
    DESCRIPTION
	"Conformance group for misc VRRP objects."
    ::= { groups 1 }

vrrpScriptGroup OBJECT-GROUP
    OBJECTS {
    	vrrpScriptName,
	vrrpScriptCommand,
	vrrpScriptInterval,
	vrrpScriptWeight,
	vrrpScriptResult
	}
    STATUS current
    DESCRIPTION
	"Conformance group for VRRP scripts."
    ::= { groups 2 }

vrrpStaticAddressGroup OBJECT-GROUP
    OBJECTS {
        vrrpStaticAddressType,
	vrrpStaticAddressValue,
	vrrpStaticAddressBroadcast,
	vrrpStaticAddressMask,
	vrrpStaticAddressScope,
	vrrpStaticAddressIfIndex,
	vrrpStaticAddressIfName,
	vrrpStaticAddressIfAlias,
	vrrpStaticAddressIsSet
	}
    STATUS current
    DESCRIPTION
	"Conformance group for static addresses."
    ::= { groups 3 }

END
